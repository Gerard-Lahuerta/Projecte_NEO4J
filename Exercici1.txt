#Individu
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTfU6oJBZhmhzzkV_0-avABPzHTdXy8851ySDbn2gq32WwaNmYxfiBtCGJGOZsMgCWjzlEGX4Zh1wqe/pub?output=csv' as row
WITH row
WHERE row.Id is not NULL
MERGE (i:Individu {IndividuID: row.Id})
SET i.Year = toInteger(row.Year), i.Name = row.name, i.Surname = row.surname, i.SecondSurname = row.second_surname

CREATE CONSTRAINT UniqueIndividuID FOR (i:Individu) REQUIRE i.IndividuID IS UNIQUE;


#Habitatge
LOAD CSV WITH HEADERS 
FROM "https://docs.google.com/spreadsheets/d/e/2PACX1vT0ZhR6BSO_M72JEmxXKs6GLuOwxm_Oy0UruLJeX8_R04KAcICuvrwn2OENQhtuvddU5RSJSclHRJf/puboutput=csv" as row 
with toInteger(row.Id_Llar) as LlarID, row.Municipi as 
Municipi, toInteger(row.Any_Padro) as AnyPadro, row.Carrer as Carrer, toInteger(row.Numero) as Numero

WHERE LlarID is not NULL and Municipi<>'null'

CREATE  (h:Habitatge {LlarID: LlarID, Municipi: Municipi, AnyPadro: AnyPadro})

SET h.Carrer = Carrer,  h.Num = Numero

CREATE CONSTRAINT FOR (h:Habitatge) REQUIRE (h.LlarID, h.Municipi, h.AnyPadro) IS NODE KEY


# Relaci√≥ viu
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRM4DPeqFmv7w6kLH5msNk6_Hdh1wuExRirgysZKO_Q70L21MKBkDISIyjvdm8shVixl5Tcw_5zCfdg/pub?output=csv' AS vivencia 
WITH vivencia
MATCH (p:Individu {IndividuID:vivencia.IND})
MATCH (h:Habitatge{LlarID:toInteger(vivencia.HOUSE_ID),Municipi:vivencia.Location,YearPadro:toInteger(vivencia.Year)})
merge (p) -[rel:VIU_A]- (h)
